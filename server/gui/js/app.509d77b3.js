(function(e){function t(t){for(var r,o,n=t[0],c=t[1],l=t[2],d=0,v=[];d<n.length;d++)o=n[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&v.push(s[o][0]),s[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(v.length)v.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,n=1;n<a.length;n++){var c=a[n];0!==s[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},s={app:0},i=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/crux/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=t,n=n.slice();for(var l=0;l<n.length;l++)t(n[l]);var u=c;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:"",color:"primary",dark:"","clipped-right":""}},[a("v-toolbar-title",{staticClass:"display-1"},[e._v("Open Client Registry")]),a("v-spacer"),a("v-toolbar-items",[e.$store.state.denyAccess?e._e():a("v-btn",{attrs:{color:"primary",to:"/"}},[a("v-icon",[e._v("mdi-home")]),e._v(" Home ")],1),e.$store.state.denyAccess?e._e():a("v-btn",{attrs:{color:"primary",to:"/review"}},[a("v-badge",{attrs:{color:"error",content:e.$store.state.totalMatchIssues}},[a("v-icon",[e._v("mdi-alert")]),e._v(" Action Required ")],1)],1),e.$store.state.denyAccess?e._e():a("v-btn",{attrs:{color:"primary",to:"/addUser"}},[a("v-icon",[e._v("mdi-account-plus")]),e._v(" Add User ")],1),e.$store.state.denyAccess?e._e():a("v-btn",{attrs:{color:"primary",to:"/logout"}},[a("v-icon",[e._v("mdi-logout")]),e._v(" Logout ")],1)],1),a("v-spacer")],1),a("v-main",[a("center",[a("v-alert",{style:{width:e.$store.state.alert.width},attrs:{type:e.$store.state.alert.type,dismissible:e.$store.state.alert.dismisible,transition:e.$store.state.alert.transition},model:{value:e.$store.state.alert.show,callback:function(t){e.$set(e.$store.state.alert,"show",t)},expression:"$store.state.alert.show"}},[e._v(" "+e._s(e.$store.state.alert.msg)+" ")])],1),a("v-dialog",{attrs:{persistent:"",width:e.$store.state.progress.width},model:{value:e.$store.state.progress.enable,callback:function(t){e.$set(e.$store.state.progress,"enable",t)},expression:"$store.state.progress.enable"}},[a("v-card",{attrs:{color:"primary",dark:""}},[a("v-card-text",[e._v(" "+e._s(e.$store.state.progress.title)+" "),a("v-progress-linear",{staticClass:"mb-0",attrs:{indeterminate:"",color:"white"}})],1)],1)],1),a("router-view")],1)],1)},i=[],o=a("2b27"),n=a.n(o),c=a("bc3a"),l=a.n(c),u=a("9b31"),d={name:"App",mixins:[u["a"]],data:function(){return{totalMatchIssues:0}},created:function(){var e=this;n.a.get("token")&&n.a.get("userID")&&(this.$store.state.auth.token=n.a.get("token"),this.$store.state.auth.userID=n.a.get("userID"),this.$store.state.auth.username=n.a.get("username"),l.a.get("/ocrux/isTokenActive/").then((function(){e.$store.state.denyAccess=!1,l.a.get("/config/getURI").then((function(t){e.$store.state.systemURI=t.data})).catch((function(e){throw e})),e.getClients()}))),this.countMatchIssues()}},v=d,h=a("2877"),m=a("6544"),p=a.n(m),f=a("0798"),_=a("7496"),b=a("40dc"),y=a("4ca6"),g=a("8336"),w=a("b0af"),k=a("99d9"),x=a("169a"),C=a("132d"),$=a("f6c4"),I=a("8e36"),V=a("2fa4"),R=a("2a7f"),D=Object(h["a"])(v,s,i,!1,null,null,null),S=D.exports;p()(D,{VAlert:f["a"],VApp:_["a"],VAppBar:b["a"],VBadge:y["a"],VBtn:g["a"],VCard:w["a"],VCardText:k["b"],VDialog:x["a"],VIcon:C["a"],VMain:$["a"],VProgressLinear:I["a"],VSpacer:V["a"],VToolbarItems:R["a"],VToolbarTitle:R["b"]});var P=a("8c4f"),M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",[a("v-spacer"),a("v-text-field",{attrs:{label:"Search Surname","hide-details":"",outlined:"",shaped:"",clearable:""},on:{change:function(t){return e.searchData()}},model:{value:e.search_family,callback:function(t){e.search_family=t},expression:"search_family"}}),a("v-text-field",{attrs:{label:"Search Given Name(s)","hide-details":"",outlined:"",shaped:"",clearable:""},on:{change:function(t){return e.searchData()}},model:{value:e.search_given,callback:function(t){e.search_given=t},expression:"search_given"}}),a("v-text-field",{attrs:{label:"Exact CRUID","hide-details":"",outlined:"",shaped:"",clearable:""},on:{change:function(t){return e.searchData()}},model:{value:e.search_uid,callback:function(t){e.search_uid=t},expression:"search_uid"}}),a("v-autocomplete",{attrs:{items:e.$store.state.clients,"item-text":"displayName","item-value":"id",clearable:"",label:"Point of Service","hide-details":"",outlined:"",shaped:""},on:{change:function(t){return e.searchData()}},model:{value:e.pos,callback:function(t){e.pos=t},expression:"pos"}})],1),a("v-data-table",{staticClass:"elevation-1",staticStyle:{cursor:"pointer"},attrs:{headers:e.headers,items:e.patients,options:e.options,"server-items-length":e.totalPatients,"footer-props":{"items-per-page-options":[5,10,20,50]},loading:e.loading},on:{"update:options":function(t){e.options=t},"click:row":e.clickIt}})],1)},E=[],N=(a("7db0"),a("a15b"),a("b0c0"),a("ac1f"),a("5319"),a("9911"),a("b85c")),O={name:"Home",mixins:[u["a"]],data:function(){return{debug:"",pos:"",search_family:"",search_given:"",search_uid:"",search_terms:[],loading:!1,totalPatients:0,prevPage:-1,link:[],options:{itemsPerPage:10,sortBy:["family"]},rowsPerPageItems:[5,10,20,50],headers:[{text:"Surname",value:"family"},{text:"Given Name(s)",value:"given"},{text:"NIN",value:"nin",sortable:!1},{text:"Gender",value:"gender"},{text:"Birth Date",value:"birthdate"},{text:"CRUID",value:"uid",sortable:!1},{text:"Point of Service",value:"pos"}],patients:[]}},watch:{options:{handler:function(){this.getData()},deep:!0}},mounted:function(){this.getData()},methods:{clickIt:function(e){this.$router.push({name:"client",params:{clientId:e.id},query:{pos:this.pos}})},searchData:function(){this.search_terms=[],this.search_family&&this.search_terms.push("family:contains="+encodeURIComponent(this.search_family)),this.search_given&&this.search_terms.push("given:contains="+encodeURIComponent(this.search_given)),this.search_uid&&this.search_terms.push("link="+encodeURIComponent(this.search_uid)),this.pos&&this.search_terms.push("_tag="+encodeURIComponent("http://openclientregistry.org/fhir/clientid|"+this.pos)),this.getData(!0)},getData:function(e){var t=this;this.loading=!0;var a="";if(e&&(this.options.page=1),this.options.page>1&&(this.options.page===this.prevPage-1?a=this.link.find((function(e){return"previous"===e.relation})).url:this.options.page===this.prevPage+1&&(a=this.link.find((function(e){return"next"===e.relation})).url),a=a.replace("http://localhost:8081/clientregistry","")),""===a){var r=this.options.itemsPerPage||10,s="";for(var i in this.options.sortBy)s&&(s+=","),this.options.sortDesc[i]&&(s+="-"),s+=this.options.sortBy[i];a="/fhir/Patient?_count="+r+"&_total=accurate&_tag:not=5c827da5-4858-4f3d-a50c-62ece001efea",this.search_terms.length>0&&(a+="&"+this.search_terms.join("&")),this.debug=a}this.prevPage=this.options.page,this.$http.get(a).then((function(e){if(t.patients=[],e.data.total>0){t.link=e.data.link;var a,r=Object(N["a"])(e.data.entry);try{for(r.s();!(a=r.n()).done;){var s=a.value;if(!(!s.resource.link||s.resource.link&&Array.isArray(s.resource.link)&&0===s.resource.link.length||s.resource.link&&!Array.isArray(s.resource.link))){var i=s.resource.name&&s.resource.name.find((function(e){return"official"===e.use}));i||(i={});var o=s.resource.identifier.find((function(e){return e.system===Object({NODE_ENV:"production",VUE_APP_CRUID_TAG:"5c827da5-4858-4f3d-a50c-62ece001efea",VUE_APP_BROKEN_MATCH_URL:"http://clientregistry.org/brokenMatch",VUE_APP_FHIR_ROOT:"http://localhost:8081/clientregistry",VUE_APP_BACKEND_SERVER:"https://localhost:3000/OCRUX",BASE_URL:"/crux/"}).VUE_APP_SYSTEM_NIN}));o||(o={});var n=void 0;if(s.resource.meta&&s.resource.meta.tag){var c,l=Object(N["a"])(s.resource.meta.tag);try{for(l.s();!(c=l.n()).done;){var u=c.value;"http://openclientregistry.org/fhir/clientid"===u.system&&(n=u.code)}}catch(v){l.e(v)}finally{l.f()}}var d=t.getClientDisplayName(n);console.log(n),t.patients.push({id:s.resource.id,family:i.family,given:i.given,birthdate:s.resource.birthDate,gender:s.resource.gender,nin:o.value,uid:s.resource.link[0].other.reference.replace("Patient/",""),pos:d})}}}catch(v){r.e(v)}finally{r.f()}}t.totalPatients=e.data.total,t.loading=!1}))}}},T=O,A=a("c6a6"),U=a("8fea"),B=a("8654"),j=Object(h["a"])(T,M,E,!1,null,null,null),q=j.exports;p()(j,{VAutocomplete:A["a"],VCard:w["a"],VCardTitle:k["c"],VDataTable:U["a"],VSpacer:V["a"],VTextField:B["a"]});var F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-tabs",{attrs:{"background-color":"secondary",dark:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider"),a("v-tab",{attrs:{href:"#record"}},[a("v-icon",[e._v("mdi-account")]),e._v("Record")],1),a("v-tab",{attrs:{href:"#history"}},[a("v-icon",[e._v("mdi-history")]),e._v("History")],1),a("v-spacer"),a("v-toolbar-items",["6f2eac1b-5b1d-49ce-a4b7-f9089128f836"===e.uid?a("v-btn",{attrs:{color:"warning"},on:{click:function(t){return e.$router.push("/resolve/590-57-2820")}}},[a("v-badge",{attrs:{icon:"mdi-alert",color:"error"}},[e._v("Review Potential Matches")])],1):e._e(),e.canGoBack?a("v-btn",{attrs:{color:"secondary"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("Back")]):a("v-btn",{attrs:{color:"secondary"},on:{click:e.close}},[e._v("Close")])],1),a("v-tab-item",{attrs:{value:"record"}},[a("v-row",[a("v-col",{attrs:{cols:"6"}},[a("v-card",{staticClass:"mx-auto"},[a("v-carousel",{attrs:{"delimiter-icon":"mdi-account","next-icon":"mdi-account-arrow-right","prev-icon":"mdi-account-arrow-left","show-arrows-on-hover":!0},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.match_items,(function(t,r){return a("v-carousel-item",{key:r+"-"+t.id},[a("v-card",{staticClass:"mx-auto",attrs:{height:"100%"}},[a("v-toolbar",{attrs:{color:"secondary",dark:""}},[a("v-toolbar-title",{staticClass:"font-weight-bold"},[e._v(" CRUID: "+e._s(e.uid)+" ")]),a("v-spacer"),e._v(" "+e._s(e.selected+1)+" / "+e._s(e.match_count)+" ")],1),a("v-list",{attrs:{dense:"",light:"",height:"100%"}},[a("v-list-item",[a("v-list-item-content",[e._v("Submitting System:")]),a("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t.system)+" ")])],1),e._l(t.name,(function(t,r){return a("v-list-item",{key:r+"-"+t.use},[a("v-list-item-content",[e._v("Name ("+e._s(t.use)+")")]),a("v-list-item-content",{staticClass:"align-end text-capitalize"},[e._v(" "+e._s(t.given.join(" "))+" "+e._s(t.family)+" ")])],1)})),a("v-list-item",[a("v-list-item-content",[e._v("Gender:")]),a("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t.gender)+" ")])],1),a("v-list-item",[a("v-list-item-content",[e._v("Birth Date:")]),a("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t.birthdate)+" ")])],1),e._l(t.telecom,(function(t,r){return a("v-list-item",{key:r+"-"+t.system},[a("v-list-item-content",{staticClass:"text-capitalize"},[e._v(" "+e._s(t.system)+": ")]),a("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t.value)+" ")])],1)})),e._l(t.identifier,(function(t,r){return a("v-list-item",{key:r+"-"+t.system},[a("v-list-item-content",[e._v(e._s(t.name)+":")]),a("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t.value)+" ")])],1)}))],2)],1)],1)})),1)],1)],1),a("v-col",{attrs:{cols:"6"}},[a("v-card",{staticClass:"mx-auto"},[a("v-toolbar",{attrs:{color:"accent",dark:""}},[a("v-toolbar-title",[e._v("Matched Records")])],1),a("v-data-table",{staticClass:"elevation-1 text-capitalize",attrs:{headers:e.match_headers,items:e.match_items,"items-per-page":20,"item-key":"id","show-select":""},model:{value:e.breaks,callback:function(t){e.breaks=t},expression:"breaks"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"warning",attrs:{disabled:0===e.breaks.length||e.match_items.length<2},on:{click:function(t){return e.breakMatch()}}},[e._v(" Break Match(es) ")])],1)],1)],1),a("v-col",{attrs:{cols:"12"}},[a("v-card",{staticClass:"mx-auto"},[a("v-toolbar",{attrs:{color:"warning",dark:""}},[a("v-toolbar-title",[e._v("Broken Matches")])],1),a("v-data-table",{staticClass:"elevation-1 text-capitalize",attrs:{headers:e.match_headers,items:e.break_items,"items-per-page":20,"item-key":"id","show-select":""},model:{value:e.unbreaks,callback:function(t){e.unbreaks=t},expression:"unbreaks"}}),a("v-card-actions",[a("v-spacer"),a("v-btn",{staticClass:"accent",attrs:{disabled:0===e.unbreaks.length},on:{click:function(t){return e.revertBreak()}}},[e._v(" Revert Break ")])],1)],1)],1)],1)],1),a("v-tab-item",{attrs:{value:"history"}},[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-card",{staticClass:"mx-auto"},[a("v-toolbar",{attrs:{color:"secondary",dark:""}},[a("v-toolbar-title",[e._v("History")])],1),a("v-expansion-panels",{attrs:{popout:""}},e._l(e.matchEvents,(function(t,r){return a("v-expansion-panel",{key:r},[a("v-expansion-panel-header",["submittedResource"===t.type?[e._v(" Submitted Resource ")]:e._e(),"breakMatch"===t.type?[e._v(" Break Match ")]:e._e(),"unBreak"===t.type?[e._v(" Revert Break ")]:e._e(),e._v(" Event "+e._s(e._f("moment")(t.recorded,"Do MMM YYYY h:mm:ss a")))],2),a("v-expansion-panel-content",["submittedResource"!==t.type?[e._v(" User: "+e._s(t.username)+" "),a("br")]:e._e(),e._v(" Operation: "),a("b",[e._v(e._s(t.operation))]),e._v(" "),a("br"),e._v(" Operation Time "+e._s(e._f("moment")(t.recorded,"Do MMM YYYY h:mm:ss a"))+" "),a("br"),e._v(" Status: "),"0"===t.outcomeCode?[a("v-chip",{attrs:{color:"green",dark:""}},[e._v(" "+e._s(t.outcome)+" ")])]:[a("v-chip",{attrs:{color:"red",dark:""}},[e._v(" "+e._s(t.outcome)+" ")])],a("br"),e._v(" IP Address: "+e._s(t.ipaddress)+" "),a("br"),"breakMatch"===t.type?a("v-row",[a("v-col",{attrs:{cols:"4"}},[a("v-card",{attrs:{elevation:"12",color:"green",hover:""}},[a("v-card-text",{staticClass:"white--text"},[e._v(" Break "),a("br"),a("b",[e._v(e._s(t.break))])])],1)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{attrs:{elevation:"12",color:"red",hover:""}},[a("v-card-text",{staticClass:"white--text"},[e._v(" Old CRUID "),a("br"),a("b",[e._v(e._s(t.CRUID))])])],1)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{attrs:{elevation:"12",color:"red",hover:""}},[a("v-card-text",{staticClass:"white--text"},[e._v(" Broken From "),a("br"),a("b",[e._l(t.breakFrom,(function(t){return[e._v(" => "+e._s(t)+" ")]}))],2)])],1)],1)],1):e._e(),"unBreak"===t.type?a("v-row",[a("v-col",{attrs:{cols:"4"}},[a("v-card",{attrs:{elevation:"12",color:"green",hover:""}},[a("v-card-text",{staticClass:"white--text"},[e._v(" Reverting "),a("br"),a("b",[e._v(e._s(t.unBreak))])])],1)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{attrs:{elevation:"12",color:"red",hover:""}},[a("v-card-text",{staticClass:"white--text"},[e._v(" Reverting From CRUID "),a("br"),a("b",[e._v(e._s(t.unBreakFromCRUID))])])],1)],1),a("v-col",{attrs:{cols:"4"}},[a("v-card",{attrs:{elevation:"12",color:"red",hover:""}},[a("v-card-text",{staticClass:"white--text"},[e._v(" Reverting From "),a("br"),a("b",[e._l(t.unBreakFrom,(function(t){return[e._v(" => "+e._s(t)+" ")]}))],2)])],1)],1)],1):e._l(t.matchData,(function(t,r){return a("v-row",{key:r},[a("v-col",{attrs:{cols:"6"}},[a("v-card",{attrs:{elevation:"12",hover:""}},[a("v-card-title",{attrs:{"primary-title":""}},[e._v(" Decision Rule "+e._s(++r)+" => Matching Type: "),a("b",[e._v(" "+e._s(t.matchingType))])]),a("v-card-text",[a("v-data-table",{attrs:{headers:e.matchRuleHeaders,items:t.decisionRule,"items-per-page":20,"item-key":"id"},scopedSlots:e._u([{key:"item.details",fn:function(r){var s=r.item;return[s.details.algorithm?[e._v(" Algorithm - "+e._s(s.details.algorithm)),a("br")]:e._e(),s.details.threshold?[e._v(" Threshold "),a("v-chip",{attrs:{color:"red",dark:""}},[e._v(" "+e._s(s.details.threshold)+" ")]),a("br")]:e._e(),"probabilistic"===t.matchingType?[a("b",[e._v("mValue")]),a("v-chip",{attrs:{color:"green",dark:""}},[e._v(" "+e._s(s.details.mValue)+" ")]),e._v(" "),a("b",[e._v("- uValue")]),a("v-chip",{attrs:{color:"blue",dark:""}},[e._v(" "+e._s(s.details.uValue)+" ")]),a("br")]:e._e(),s.details.fhirpath?[e._v(" FHIR Path - "+e._s(s.details.fhirpath)+" ")]:e._e(),a("br"),a("br")]}}],null,!0)})],1)],1)],1),a("v-col",{attrs:{cols:"6"}},[a("v-switch",{attrs:{label:"View Advanced Details"},model:{value:e.advancedView,callback:function(t){e.advancedView=t},expression:"advancedView"}}),e.advancedView?[a("v-card",[a("v-card-text",[a("v-textarea",{attrs:{filled:"",color:"deep-purple",label:"Elasticsearch Query",rows:"10",value:t.query}})],1)],1),a("v-card",[a("v-card-text",[a("v-textarea",{attrs:{filled:"",color:"deep-purple",label:"Elasticsearch Automatches Results",rows:"10",value:t.autoMatches}})],1)],1),a("v-card",[a("v-card-text",[a("v-textarea",{attrs:{filled:"",color:"deep-purple",label:"Elasticsearch Potential Matches Results",rows:"10",value:t.potentialMatches}})],1)],1),a("v-card",[a("v-card-text",[a("v-textarea",{attrs:{filled:"",color:"deep-purple",label:"Elasticsearch Conflicts Matches Results",rows:"10",value:t.conflictsMatchResults}})],1)],1)]:e._e()],2)],1)}))],2)],1)})),1)],1)],1)],1)],1)],1)],1)},L=[],Y=a("7709"),H=Y["a"],G=a("5e66"),z=a("3e35"),J=a("cc20"),K=a("62ad"),X=a("a523"),Z=a("cd55"),Q=a("49e2"),W=a("c865"),ee=a("0393"),te=a("8860"),ae=a("da13"),re=a("5d23"),se=a("0fd9"),ie=a("b73d"),oe=a("71a3"),ne=a("c671"),ce=a("fe57"),le=a("9a96"),ue=a("a844"),de=a("71d9"),ve=Object(h["a"])(H,F,L,!1,null,null,null),he=ve.exports;p()(ve,{VBadge:y["a"],VBtn:g["a"],VCard:w["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:k["c"],VCarousel:G["a"],VCarouselItem:z["a"],VChip:J["a"],VCol:K["a"],VContainer:X["a"],VDataTable:U["a"],VExpansionPanel:Z["a"],VExpansionPanelContent:Q["a"],VExpansionPanelHeader:W["a"],VExpansionPanels:ee["a"],VIcon:C["a"],VList:te["a"],VListItem:ae["a"],VListItemContent:re["a"],VRow:se["a"],VSpacer:V["a"],VSwitch:ie["a"],VTab:oe["a"],VTabItem:ne["a"],VTabs:ce["a"],VTabsSlider:le["a"],VTextarea:ue["a"],VToolbar:de["a"],VToolbarItems:R["a"],VToolbarTitle:R["b"]});var me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",[a("v-card-title",[e._v(" Action Required "),a("v-spacer")],1),a("v-data-table",{staticClass:"elevation-1",staticStyle:{cursor:"pointer"},attrs:{headers:e.headers,items:e.reviews,options:e.options,"footer-props":{"items-per-page-options":[5,10,20,50]},loading:e.loading},on:{"update:options":function(t){e.options=t},"click:row":e.clickIt},scopedSlots:e._u([{key:"item.uid",fn:function(t){var r=t.item;return[a("router-link",{attrs:{to:"/resolve/"+r.id+"?flagType="+r.reasonCode}},[e._v(e._s(r.uid))])]}},{key:"item.reason",fn:function(t){var r=t.item;return[a("span",{staticClass:"text-uppercase"},[e._v(e._s(r.reason))])]}},{key:"item.source",fn:function(t){var r=t.item;return[a("span",{staticClass:"text-uppercase"},[e._v(e._s(e.getClientDisplayName(r.source)))])]}},{key:"item.date",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("moment")(a.date,"MMMM DD YYYY HH:mm:ssZ"))+" ")]}}])})],1)},pe=[],fe={mixins:[u["a"]],name:"Review",components:{},data:function(){return{reviews:[],debug:"",search:"",loading:!1,prevPage:-1,link:[],options:{itemsPerPage:10,sortBy:["family"]},rowsPerPageItems:[5,10,20,50],headers:[{text:"CR ID",value:"uid"},{text:"Surname",value:"family"},{text:"Given Names",value:"given"},{text:"Source",value:"source"},{text:"Source ID",value:"source_id"},{text:"Reason",value:"reason"},{text:"Date Flagged",value:"date"}]}},methods:{getReviews:function(){var e=this;l.a.get("/match/get-match-issues").then((function(t){e.reviews=t.data}))},clickIt:function(e){this.$router.push({name:"review",params:{clientId:e.uid}})}},created:function(){this.getReviews()}},_e=fe,be=Object(h["a"])(_e,me,pe,!1,null,null,null),ye=be.exports;p()(be,{VCard:w["a"],VCardTitle:k["c"],VDataTable:U["a"],VSpacer:V["a"]});var ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-navigation-drawer",{attrs:{color:"secondary",right:"",permanent:"",clipped:"",app:""}},[a("v-list",[a("v-list-item",[a("v-btn",{attrs:{color:"accent"},on:{click:function(t){e.showMatrix=!0,e.$vuetify.goTo(e.$refs.scoreMatrix)}}},[e._v("Show Scores Matrix")])],1),a("v-list-item",[a("v-btn",{attrs:{color:"success"},on:{click:function(t){e.showReview=!0}}},[e._v(" Save Changes ")])],1),a("v-divider"),a("v-list-item",[a("h3",{staticClass:"white--text"},[e._v("Options")])]),a("v-list-item",[a("v-switch",{attrs:{dark:"",label:"Use Simplified Label?"},on:{change:e.setupCRIDList},model:{value:e.useNickname,callback:function(t){e.useNickname=t},expression:"useNickname"}})],1),a("v-list-item",[a("v-switch",{attrs:{dark:"",label:"Include Actual CR ID with Temporary CR ID?"},on:{change:e.setupCRIDList},model:{value:e.includeCRID,callback:function(t){e.includeCRID=t},expression:"includeCRID"}})],1)],1)],1),a("v-dialog",{attrs:{value:e.showReview,"max-width":"900",persistent:""}},[a("v-card",{attrs:{light:""}},[a("v-card-title",[a("v-toolbar",{attrs:{color:"primary",dark:""}},[a("v-toolbar-title",{staticClass:"font-weight-bold"},[e._v(" Review Changes ")]),a("v-spacer"),a("v-toolbar-items",[a("v-btn",{attrs:{icon:""},on:{click:function(t){e.showReview=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1)],1)],1),e.bucketsModified?a("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.review_headers,items:e.review_list,"disable-pagination":!0,"hide-default-footer":!0}}):a("v-card-text",[e._v(" No changes have been made, are you sure you want to go ahead and remove the flag? ")]),a("v-card-actions",[a("v-btn",{attrs:{color:"error"},on:{click:function(t){e.showReview=!1}}},[e._v(" Cancel ")]),a("v-spacer"),a("v-btn",{attrs:{color:"success"},on:{click:e.saveChanges}},[e._v(" Save ")])],1)],1)],1),a("v-dialog",{attrs:{value:e.cohortPopup,width:"500"}},[a("v-card",{attrs:{light:""}},[a("v-card-title",{staticClass:"secondary lighten-1",attrs:{color:"white","primary-title":""}},[e._v(" Move All? ")]),a("v-card-text",[e._v(" Do you want to include all the other records from this CR ID and move them all to the new CR IDâ€ ")]),a("v-card-actions",[a("v-btn",{attrs:{color:"info"},on:{click:e.copyClient}},[e._v("Move this one record")]),a("v-spacer"),a("v-btn",{attrs:{color:"warning"},on:{click:e.copyCohort}},[e._v("Move all records")])],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"error"},on:{click:function(t){e.copyCohortInfo=null,e.cohortPopup=!1}}},[e._v("Cancel")])],1)],1)],1),e._l(e.crids,(function(t,r){return a("v-row",{key:r},[a("v-col",{attrs:{cols:"12"}},[a("v-card",[a("v-card-title",[a("v-toolbar",{attrs:{color:"primary darken-1",dark:""}},[e.useNickname?a("v-toolbar-title",{staticClass:"font-weight-bold"},[e._v(" "+e._s(e.nickname[r])+" ")]):e._e(),a("v-spacer"),a("v-toolbar-title",{staticClass:"font-weight-bold"},[e._v(" CR ID: "+e._s(r)+" ")])],1)],1),a("v-data-table",{staticClass:"elevation-1",staticStyle:{cursor:"pointer"},attrs:{headers:e.headers,items:t,"disable-pagination":!0,"hide-default-footer":!0,loading:e.loading},scopedSlots:e._u([{key:"header.uid",fn:function(t){return[e._v(" "+e._s(e.cridHeader)+" ")]}},{key:"item.uid",fn:function(t){var r=t.item;return[a("v-select",{key:r.source+r.source_id,attrs:{value:r.uid,items:e.crid_list,"success-messages":"Original: "+e.cridDisplay(r.ouid),dense:""},on:{change:function(t){return e.moveClient(t,r)}}})]}},{key:"item.source_id",fn:function(t){var r=t.item;return[a("a",{on:{click:function(t){return e.goTo("client",{clientId:r.uid,sourceId:r.source_id})}}},[e._v(e._s(r.source_id))])]}},{key:"item.view",fn:function(t){var r=t.item;return[a("v-switch",{attrs:{"hide-details":""},on:{change:function(t){e.showCard[r.source_id]&&e.$vuetify.goTo(e.$refs.fullCards)}},model:{value:e.showCard[r.source_id],callback:function(t){e.$set(e.showCard,r.source_id,t)},expression:"showCard[item.source_id]"}})]}},{key:"item.score",fn:function(t){var r=t.item;return[a("v-switch",{attrs:{"hide-details":""},model:{value:e.showScore[r.source_id],callback:function(t){e.$set(e.showScore,r.source_id,t)},expression:"showScore[item.source_id]"}})]}},{key:"item.birthdate",fn:function(t){var a=t.item;return[e._v(" "+e._s(e._f("moment")(a.birthdate,"MMMM DD YYYY"))+" ")]}}],null,!0)})],1)],1)],1)})),a("v-row",{ref:"scoreMatrix"},[e.showMatrix?a("v-col",{attrs:{cols:"12"}},[a("v-card",[a("v-card-title",[a("v-toolbar",{attrs:{color:"accent",dark:""}},[a("v-toolbar-title",{staticClass:"font-weight-bold"},[e._v(" Scores Matrix ")]),a("v-spacer"),a("v-toolbar-items",[a("v-btn",{attrs:{icon:""},on:{click:function(t){e.showMatrix=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1)],1)],1),a("v-data-table",{staticClass:"elevation-1",staticStyle:{cursor:"pointer"},attrs:{headers:e.score_headers,items:e.score_matrix,"disable-pagination":!0,"hide-default-footer":!0}})],1)],1):e._e()],1),a("v-row",{ref:"fullCards"},[e._l(e.resolves,(function(t){return[e.showCard[t.source_id]?a("v-col",{key:t.source_id,attrs:{cols:"4"}},[a("v-card",{ref:t.source+t.source_id,refInFor:!0,staticClass:"mx-auto",attrs:{light:"",id:t.source+t.source_id}},[a("v-toolbar",{attrs:{color:"secondary",dark:""}},[a("v-toolbar-title",{staticClass:"font-weight-bold"},[e._v(" Source: "+e._s(t.source)+" "+e._s(t.source_id)+" ")]),a("v-spacer"),a("v-toolbar-items",[a("v-btn",{attrs:{icon:""},on:{click:function(a){e.showCard[t.source_id]=!1}}},[a("v-icon",[e._v("mdi-close")])],1)],1)],1),a("v-list",{attrs:{dense:"",light:"",height:"100%"}},[e._l(e.fields,(function(r,s){return a("v-list-item",{key:s},[a("v-list-item-content",[e._v(e._s(r)+":")]),e.dates[s]?a("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(e._f("moment")(t[s],"MMMM Do YYYY"))+" ")]):a("v-list-item-content",{staticClass:"align-end"},[e._v(" "+e._s(t[s])+" ")])],1)})),a("v-divider"),a("v-list-item",[a("h5",{staticClass:"text-uppercase"},[e._v("Scores")])]),e._l(t.scores,(function(r,s){return a("v-list-item",{key:t.source_id+"-"+s},[a("v-list-item-content",[e._v(e._s(e.getSource(s)))]),a("v-list-item-content",[e._v(e._s(s)+":")]),a("v-list-item-content",[e._v(e._s(r))])],1)}))],2)],1)],1):e._e()]}))],2)],2)},we=[],ke=(a("4de4"),a("d81d"),a("b64b"),"Assign to new CR ID"),xe="New CR ID ",Ce=function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[a],e[a]=r}},$e={name:"Resolve",mixins:[u["a"]],components:{},data:function(){return{crids:{},crid_list:[],showCard:{},showScore:{},showMatrix:!1,showReview:!1,cohortPopup:!1,resolves:[],loading:!1,newIdx:1,headers:[{text:this.cridHeader,value:"uid",sortable:!1},{text:"Source",value:"source"},{text:"Source ID",value:"source_id"},{text:"Surname",value:"family"},{text:"Given Names",value:"given"},{text:"Birth Date",value:"birthdate"},{text:"Gender",value:"gender"},{text:"Full View",value:"view",sortable:!1},{text:"Scores",value:"score",sortable:!1}],dates:{birthdate:!0},fields:{source:"Submitting System",source_id:"System ID",family:"Family Name",given:"Given Name",gender:"Gender",birthdate:"Birth Date"},score_matrix:[],score_headers:[{text:"Source",value:"name"}],review_headers:[{text:"Source",value:"source"},{text:"Source ID",value:"source_id"},{text:"Original CR ID",value:"ouid"},{text:"New CR ID",value:"uid"}],review_list:[],copyCohortInfo:null,useNickname:!0,includeCRID:!1,available_nicknames:["Aluminum","Beryllium","Carbon","Dysprosium","Europium","Flourine","Gallium","Hydrogen","Iron","Krypton","Lithium","Magnesium","Nitrogen","Oxygen","Phosphorus","Copper","Sodium","Titanium","Uranium","Vanadium","Xenon","Gold","Zinc"],nickname:{}}},watch:{showScore:{handler:function(e){for(var t=this,a=function(){var a=s[r];e[a]?t.headers.find((function(e){return e.value===a}))||t.headers.push({text:t.getSource(a)+" "+a,value:a}):t.headers=t.headers.filter((function(e){return e.value!==a}))},r=0,s=Object.keys(e);r<s.length;r++)a()},deep:!0}},created:function(){var e=this;l.a.get("/match/potential-matches/".concat(this.$route.params.clientId)).then((function(t){e.resolves=t.data,Ce(e.available_nicknames),e.organizeResolves(!0)}))},computed:{cridHeader:function(){return this.useNickname?"Temporary CR ID"+(this.includeCRID?" / Actual CR ID":""):"CR ID"},bucketsModified:function(){var e,t=Object(N["a"])(this.resolves);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(a.uid!==a.ouid)return!0}}catch(r){t.e(r)}finally{t.f()}return!1}},methods:{organizeResolves:function(e){this.loading=!0;for(var t=0,a=Object.keys(this.crids);t<a.length;t++){var r=a[t];this.crids[r]=[]}this.review_list=[];var s,i=Object(N["a"])(this.resolves);try{for(i.s();!(s=i.n()).done;){var o=s.value;if(e){var n={};console.log(this.getClientDisplayName(o.source_id)),n.name=o.source+" "+o.source_id,this.score_headers.push({text:n.name,value:o.source_id});for(var c=0,l=Object.keys(o.scores);c<l.length;c++){var u=l[c];o[u]=o.scores[u],n[u]=o.scores[u]}this.score_matrix.push(n),o.ouid=o.uid}this.crids[o.uid]||(this.crids[o.uid]=[],this.nickname[o.uid]=this.available_nicknames.pop()),this.crids[o.uid].push(o),o.ouid!==o.uid&&this.review_list.push(o)}}catch(d){i.e(d)}finally{i.f()}this.setupCRIDList(),this.loading=!1},setupCRIDList:function(){var e=this;this.crid_list=Object.keys(this.crids).map((function(t){return{text:e.cridDisplay(t),value:t}})),this.crid_list.push({divider:!0}),this.crid_list.push({text:ke,value:ke})},cridDisplay:function(e){return this.useNickname?this.nickname[e]+(this.includeCRID?" ("+e+")":""):e},getSource:function(e){return this.resolves.find((function(t){return t.source_id===e})).source},moveClient:function(e,t){this.copyCohortInfo={old_id:t.uid,new_id:e,item:t},this.cohortPopup=!0},copyClient:function(){if(this.copyCohortInfo){var e=this.copyCohortInfo.item;this.copyCohortInfo.new_id===ke?(e.uid=xe+this.newIdx,this.nickname[e.uid]=this.available_nicknames.pop(),this.newIdx++):e.uid=this.copyCohortInfo.new_id,this.organizeResolves()}this.copyCohortInfo=null,this.cohortPopup=!1},copyCohort:function(){var e=this;if(this.copyCohortInfo){this.copyCohortInfo.new_id===ke&&(this.copyCohortInfo.new_id=xe+this.newIdx,this.nickname[this.copyCohortInfo.new_id]=this.available_nicknames.pop(),this.newIdx++);var t,a=Object(N["a"])(this.resolves.filter((function(t){return t.uid===e.copyCohortInfo.old_id})));try{for(a.s();!(t=a.n()).done;){var r=t.value;r.uid=this.copyCohortInfo.new_id}}catch(s){a.e(s)}finally{a.f()}this.organizeResolves()}this.copyCohortInfo=null,this.cohortPopup=!1},goTo:function(e,t){var a=this.$router.resolve({name:e,params:t});window.open(a.href,"_blank")},saveChanges:function(){var e=this;this.$store.state.progress.enable=!0,this.$store.state.progress.title="Saving...";var t=!0;this.bucketsModified&&(t=!1);var a={resolvingFrom:this.$route.params.clientId,resolves:this.resolves,removeFlag:t,flagType:this.$route.query.flagType};l.a.post("/match/resolve-match-issue",a).then((function(){e.countMatchIssues(),e.showReview=!1,e.$store.state.progress.enable=!1,e.$store.state.alert.show=!0,e.$store.state.alert.width="500px",e.$store.state.alert.msg="Operation successful",e.$store.state.alert.type="success"})).catch((function(t){e.showReview=!1,e.$store.state.progress.enable=!1,e.$store.state.alert.show=!0,e.$store.state.alert.width="500px",e.$store.state.alert.msg="Error occured, operation failed",e.$store.state.alert.type="error",console.log(t)}))}}},Ie=$e,Ve=a("ce7e"),Re=a("f774"),De=a("b974"),Se=Object(h["a"])(Ie,ge,we,!1,null,null,null),Pe=Se.exports;p()(Se,{VBtn:g["a"],VCard:w["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:k["c"],VCol:K["a"],VContainer:X["a"],VDataTable:U["a"],VDialog:x["a"],VDivider:Ve["a"],VIcon:C["a"],VList:te["a"],VListItem:ae["a"],VListItemContent:re["a"],VNavigationDrawer:Re["a"],VRow:se["a"],VSelect:De["a"],VSpacer:V["a"],VSwitch:ie["a"],VToolbar:de["a"],VToolbarItems:R["a"],VToolbarTitle:R["b"]});var Me=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-spacer"),a("v-flex",{attrs:{xs6:""}},[a("v-card",{staticClass:"mx-auto",staticStyle:{"max-width":"500px"}},[a("v-system-bar",{attrs:{color:"primary",dark:""}}),a("v-toolbar",{attrs:{color:"secondary",cards:"",dark:"",flat:""}},[a("v-card-title",{staticClass:"title font-weight-regular"},[e._v("Add New User")])],1),a("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[a("v-text-field",{attrs:{required:"","error-messages":e.firstnameErrors,filled:"",color:"deep-purple",label:"First Name*"},on:{blur:function(t){return e.$v.firstName.$touch()},change:function(t){return e.$v.firstName.$touch()}},model:{value:e.firstName,callback:function(t){e.firstName=t},expression:"firstName"}}),a("v-text-field",{attrs:{filled:"",color:"deep-purple",label:"Middle Names"},model:{value:e.otherName,callback:function(t){e.otherName=t},expression:"otherName"}}),a("v-text-field",{attrs:{required:"","error-messages":e.surnameErrors,filled:"",color:"deep-purple",label:"Surname*"},on:{blur:function(t){return e.$v.surname.$touch()},change:function(t){return e.$v.surname.$touch()}},model:{value:e.surname,callback:function(t){e.surname=t},expression:"surname"}}),a("v-text-field",{attrs:{required:"","error-messages":e.usernameErrors,filled:"",color:"deep-purple",label:"Username*"},on:{blur:function(t){return e.$v.userName.$touch()},change:function(t){return e.$v.surname.$touch()}},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}}),a("v-text-field",{attrs:{required:"","error-messages":e.passwordErrors,type:"password",filled:"",color:"deep-purple",label:"Password*"},on:{blur:function(t){return e.$v.password.$touch()},change:function(t){return e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("v-text-field",{attrs:{label:"Re-type Password*",required:"",type:"password",filled:"",color:"deep-purple","error-messages":e.retype_passwordErrors},on:{blur:function(t){return e.$v.retype_password.$touch()},change:function(t){return e.$v.retype_password.$touch()}},model:{value:e.retype_password,callback:function(t){e.retype_password=t},expression:"retype_password"}})],1),a("v-divider"),a("v-card-actions",[a("v-btn",{attrs:{text:""},on:{click:function(t){return e.$refs.form.reset()}}},[a("v-icon",[e._v("mdi-clear")]),e._v("Clear ")],1),a("v-spacer"),a("v-btn",{staticClass:"white--text",attrs:{depressed:"",disabled:e.$v.$invalid,color:"deep-purple accent-4"},on:{click:function(t){return e.addUser()}}},[a("v-icon",{attrs:{left:""}},[e._v(" mdi-language ")]),e._v("Add ")],1)],1)],1)],1),a("v-spacer")],1)],1)},Ee=[],Ne=a("b5ae"),Oe={validations:{userName:{required:Ne["required"]},retype_password:{required:Ne["required"]},password:{required:Ne["required"]},firstName:{required:Ne["required"]},surname:{required:Ne["required"]}},data:function(){return{firstName:"",otherName:"",surname:"",userName:"",password:"",retype_password:""}},computed:{firstnameErrors:function(){var e=[];return this.$v.firstName.$dirty?(!this.$v.firstName.required&&e.push("First Name is required"),e):e},surnameErrors:function(){var e=[];return this.$v.surname.$dirty?(!this.$v.surname.required&&e.push("Surname is required"),e):e},usernameErrors:function(){var e=[];return this.$v.userName.$dirty?(!this.$v.userName.required&&e.push("Username is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e},retype_passwordErrors:function(){var e=[];return this.$v.retype_password.$dirty?(!this.$v.retype_password.required&&e.push("Re-type Password"),e):e}},methods:{addUser:function(){var e=this;if(this.password!==this.retype_password)return this.$store.state.dialogError=!0,this.$store.state.errorTitle="Error",void(this.$store.state.errorDescription="Password mismatch");this.$store.state.dynamicProgress=!0,this.$store.state.progressTitle="Saving User";var t=new FormData;t.append("firstName",this.firstName),t.append("otherName",this.otherName),t.append("password",this.password),t.append("userName",this.userName),t.append("surname",this.surname),l.a.post("/user/addUser/",t,{headers:{"Content-Type":"multipart/form-data"}}).then((function(){e.$store.state.alert.show=!0,e.$store.state.alert.width="500px",e.$store.state.alert.msg="User added successfully",e.$store.state.alert.type="success",e.$refs.form.reset()})).catch((function(){e.$store.state.alert.show=!0,e.$store.state.alert.width="500px",e.$store.state.alert.msg="This user was not added, ensure userName is not used",e.$store.state.alert.type="error"}))}}},Te=Oe,Ae=a("0e8f"),Ue=a("4bd4"),Be=a("a722"),je=a("afd9"),qe=Object(h["a"])(Te,Me,Ee,!1,null,null,null),Fe=qe.exports;p()(qe,{VBtn:g["a"],VCard:w["a"],VCardActions:k["a"],VCardTitle:k["c"],VContainer:X["a"],VDivider:Ve["a"],VFlex:Ae["a"],VForm:Ue["a"],VIcon:C["a"],VLayout:Be["a"],VSpacer:V["a"],VSystemBar:je["a"],VTextField:B["a"],VToolbar:de["a"]});var Le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("center",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs3:""}}),a("v-flex",{attrs:{xs6:""}},[a("v-alert",{attrs:{type:"error",value:e.authStatus}},[e._v(" Authentication Failed ")])],1)],1),a("v-card",{attrs:{width:"430px",hover:""}},[a("v-card-title",{attrs:{"primary-title":""}},[a("v-toolbar",{staticStyle:{color:"white"},attrs:{color:"primary"}},[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs2:"","text-xs-left":""}},[a("v-icon",{attrs:{"x-large":"",color:"white"}},[e._v(" mdi-lock ")])],1),a("v-flex",{attrs:{xs9:"","text-xs-right":""}},[a("b",[e._v("Login")])])],1)],1)],1),a("v-card-text",[a("v-form",{ref:"form",staticClass:"pa-3 pt-4"},[a("v-text-field",{attrs:{required:"",filled:"",color:"deep-purple",label:"Username","error-messages":e.usernameErrors},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.authenticate()},blur:function(t){return e.$v.username.$touch()},change:function(t){return e.$v.username.$touch()}},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),a("v-text-field",{attrs:{required:"",filled:"",type:"password",color:"deep-purple",label:"Password","error-messages":e.passwordErrors},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.authenticate()},blur:function(t){return e.$v.password.$touch()},change:function(t){return e.$v.password.$touch()}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1),a("v-card-actions",[a("v-toolbar",[a("v-spacer"),a("v-btn",{staticClass:"white--text",attrs:{color:"primary",depressed:"",disabled:e.$v.$invalid},on:{click:function(t){return e.authenticate()}}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-lock-open-variant")]),e._v(" Login ")],1)],1)],1)],1)],1)],1)},Ye=[],He={mixins:[u["a"]],validations:{username:{required:Ne["required"]},password:{required:Ne["required"]}},data:function(){return{username:"",password:"",authStatus:!1}},methods:{authenticate:function(){var e=this,t=new FormData;t.append("username",this.username),t.append("password",this.password);var a={username:this.username,password:this.password};l()({method:"POST",url:"/user/authenticate",params:a}).then((function(t){e.countMatchIssues(),e.getClients(),e.$store.state.auth.token=t.data.token,e.$store.state.auth.username=e.username,e.$store.state.auth.userID=t.data.userID,n.a.config("30d"),n.a.set("token",e.$store.state.auth.token,"infinity"),n.a.set("userID",e.$store.state.auth.userID,"infinity"),n.a.set("username",e.$store.state.auth.username,"infinity"),e.$store.state.auth.role=t.data.role,t.data.token?(e.$store.state.denyAccess=!1,e.$router.push({name:"home"})):e.authStatus=!0})).catch((function(e){if(e.hasOwnProperty("response"))throw e}))}},computed:{usernameErrors:function(){var e=[];return this.$v.username.$dirty?(!this.$v.username.required&&e.push("Username is required"),e):e},passwordErrors:function(){var e=[];return this.$v.password.$dirty?(!this.$v.password.required&&e.push("Password is required"),e):e}}},Ge=He,ze=Object(h["a"])(Ge,Le,Ye,!1,null,null,null),Je=ze.exports;p()(ze,{VAlert:f["a"],VBtn:g["a"],VCard:w["a"],VCardActions:k["a"],VCardText:k["b"],VCardTitle:k["c"],VContainer:X["a"],VFlex:Ae["a"],VForm:Ue["a"],VIcon:C["a"],VLayout:Be["a"],VSpacer:V["a"],VTextField:B["a"],VToolbar:de["a"]});var Ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{attrs:{"grid-list-xs":""}})},Xe=[],Ze={mounted:function(){this.$store.state.auth.token="",n.a.remove("token"),n.a.remove("userID"),n.a.remove("role"),n.a.remove("username"),this.$router.push("login"),this.$store.state.denyAccess=!0}},Qe=Ze,We=Object(h["a"])(Qe,Ke,Xe,!1,null,null,null),et=We.exports;p()(We,{VContainer:X["a"]});a("d3b7");var tt=a("2f62");r["a"].use(tt["a"]);var at=new tt["a"].Store({state:{totalMatchIssues:0,clients:[],systemURI:{},auth:{username:"",userID:"",role:"",token:""},alert:{width:"800px",show:!1,msg:"",type:"success",dismisible:!0,transition:"scale-transition"},progress:{enable:!1,width:"300",title:""},denyAccess:!0,dialogError:!1,errorTitle:"",errorDescription:"",errorColor:"primary",dynamicProgress:!1}});l.a.interceptors.request.use((function(e){var t=at.state.auth.token;return t&&(e.headers["Authorization"]="Bearer ".concat(t)),e}),(function(e){return Promise.reject(e)})),l.a.interceptors.response.use((function(e){return e}),(function(e){var t=e.response.status;return 401===t&&(at.state.auth.token="",n.a.remove("token"),it.push("login")),Promise.reject(e)})),r["a"].use(P["a"]);var rt=[{path:"/",name:"home",component:q},{path:"/client/:clientId",name:"client",component:he},{path:"/review",name:"review",component:ye},{path:"/resolve/:clientId?",name:"resolve",component:Pe},{path:"/addUser",name:"AddUser",component:Fe},{path:"/login",name:"Login",component:Je},{path:"/logout",name:"Logout",component:et}],st=new P["a"]({routes:rt});st.beforeEach((function(e,t,a){if(at.state.auth.token||n.a.get("token")&&"null"!==n.a.get("token")&&n.a.get("userID")&&"null"!==n.a.get("userID"))a();else{if(at.state.denyAccess=!0,"/Login"===e.path)return a();a({path:"/Login"})}}));var it=st,ot=a("f309");r["a"].use(ot["a"]);var nt=new ot["a"]({theme:{options:{customProperties:!0},themes:{light:{primary:{base:"#569fd3",darken1:"0d3552",darken2:"011b2d",lighten1:"ddecf6",lighten2:"f4f7f9"},secondary:{base:"#5f6062",darken1:"04070e",lighten1:"e5e5e5"},accent:"#78496a",error:"#b32317",info:"#005595",success:"#8a8d35",warning:"#d06f1a"}}}}),ct=a("1dce"),lt=a.n(ct),ut=a("a7fe"),dt=a.n(ut);r["a"].config.productionTip=!1,r["a"].use(dt.a,l.a),r["a"].use(lt.a),r["a"].use(a("2ead")),new r["a"]({router:it,store:at,vuetify:nt,render:function(e){return e(S)}}).$mount("#app")},7709:function(e,t,a){"use strict";(function(e){a("7db0"),a("a15b"),a("b0c0"),a("d3b7"),a("ac1f"),a("25f0"),a("1276"),a("9911");var r=a("b85c"),s=a("9b31");t["a"]={mixins:[s["a"]],name:"Client",data:function(){return{tab:"record",advancedView:!1,outcomes:{0:"Success",4:"Minor Failure - Client Error",8:"Serious Failure - Server Error",12:"Major Failure - Server Crashed"},selected:"",matchEvents:[],matchRule:[],auditEvent:[],systems:{},primary_systems:[Object({NODE_ENV:"production",VUE_APP_CRUID_TAG:"5c827da5-4858-4f3d-a50c-62ece001efea",VUE_APP_BROKEN_MATCH_URL:"http://clientregistry.org/brokenMatch",VUE_APP_FHIR_ROOT:"http://localhost:8081/clientregistry",VUE_APP_BACKEND_SERVER:"https://localhost:3000/OCRUX",BASE_URL:"/crux/"}).VUE_APP_SYSTEM_OPENMRS],match_count:0,uid:"",breaks:[],unbreaks:[],matchRuleHeaders:[{text:"Field",value:"name"},{text:"Field Details",value:"details"}],match_headers:[{text:"Submitting System",value:"system"},{text:"Record ID",value:"id"},{text:"Surname",value:"family"},{text:"Given Name(s)",value:"given"},{text:"Gender",value:"gender"},{text:"Birth Date",value:"birthdate"}],match_items:[],break_items:[]}},computed:{canGoBack:function(){return history.length>1}},mounted:function(){this.getPatient(),this.getAuditEvents()},methods:{getPatient:function(){var e=this;this.breaks=[],this.match_items=[],this.break_items=[],this.match_count=0,this.$http.get("/fhir/Patient?_elements=link,extension&_id="+this.$route.params.clientId).then((function(t){var a=t.data.entry[0].resource.link[0].other.reference.split("/").pop(),s=t.data.entry[0].resource,i=[];if(s.extension){var o,n=Object(r["a"])(s.extension);try{for(n.s();!(o=n.n()).done;){var c=o.value;"http://clientregistry.org/brokenMatch"===c.url&&i.push(c.valueReference.reference.split("/").pop())}}catch(l){n.e(l)}finally{n.f()}}i.length>0&&(i=i.join(","),e.$http.get("/fhir/Patient?_id="+i).then((function(t){var a,s=Object(r["a"])(t.data.entry);try{for(s.s();!(a=s.n()).done;){var i=a.value,o=i.resource,n=void 0,c=void 0,u=void 0,d=void 0,v=void 0;if(o.meta&&o.meta.tag){var h,m=Object(r["a"])(o.meta.tag);try{for(m.s();!(h=m.n()).done;){var p=h.value;"http://openclientregistry.org/fhir/clientid"===p.system&&(v=p.code)}}catch(l){m.e(l)}finally{m.f()}}c=e.getClientDisplayName(v);var f=[];if(o.identifier){var _,b=Object(r["a"])(o.identifier);try{for(b.s();!(_=b.n()).done;){var y=_.value,g=e.getSystemURIDisplayName(y.system);g?("internalid"===g.id&&(n=y.value),f.push({name:g.name,value:y.value})):f.push({name:y.system,value:y.value})}}catch(l){b.e(l)}finally{b.f()}}try{u=o.name.find((function(e){return"official"===e.use}))}catch(l){u={family:"",given:[]}}try{d=o.telecom.find((function(e){return e.system="phone"})).value}catch(l){d=""}e.$route.query.pos&&e.$route.query.pos===v?e.break_items.unshift({fid:o.id,system:c,id:n,gender:o.gender,birthdate:o.birthDate,name:o.name,telecom:o.telecom,identifier:f,family:u.family,given:u.given.join(" "),phone:d}):e.break_items.push({fid:o.id,system:c,id:n,gender:o.gender,birthdate:o.birthDate,name:o.name,telecom:o.telecom,identifier:f,family:u.family,given:u.given.join(" "),phone:d})}}catch(l){s.e(l)}finally{s.f()}}))),e.$http.get("/fhir/Patient?_include=Patient:link&_id="+a).then((function(t){var a,s=Object(r["a"])(t.data.entry);try{for(s.s();!(a=s.n()).done;){var i=a.value,o=i.resource;if(o.meta.tag&&void 0!==o.meta.tag.find((function(e){return"5c827da5-4858-4f3d-a50c-62ece001efea"===e.code})))e.uid=o.id;else{o.id===e.$route.params.clientId&&(e.selected=e.match_count);var n=void 0,c=void 0,u=void 0,d=void 0,v=void 0;if(o.meta&&o.meta.tag){var h,m=Object(r["a"])(o.meta.tag);try{for(m.s();!(h=m.n()).done;){var p=h.value;"http://openclientregistry.org/fhir/clientid"===p.system&&(v=p.code)}}catch(l){m.e(l)}finally{m.f()}}c=e.getClientDisplayName(v);var f=[];if(o.identifier){var _,b=Object(r["a"])(o.identifier);try{for(b.s();!(_=b.n()).done;){var y=_.value,g=e.getSystemURIDisplayName(y.system);g&&g.name?("internalid"===g.id&&(n=y.value),f.push({name:g.name,value:y.value})):f.push({name:y.system,value:y.value})}}catch(l){b.e(l)}finally{b.f()}}try{u=o.name.find((function(e){return"official"===e.use}))}catch(l){u={family:"",given:[]}}try{d=o.telecom.find((function(e){return e.system="phone"})).value}catch(l){d=""}e.$route.query.pos&&e.$route.query.pos===v?e.match_items.unshift({fid:o.id,selectIdx:e.match_count,system:c,id:n,gender:o.gender,birthdate:o.birthDate,name:o.name,telecom:o.telecom,identifier:f,family:u.family,given:u.given.join(" "),phone:d}):e.match_items.push({fid:o.id,selectIdx:e.match_count,system:c,id:n,gender:o.gender,birthdate:o.birthDate,name:o.name,telecom:o.telecom,identifier:f,family:u.family,given:u.given.join(" "),phone:d}),e.match_count++}}}catch(l){s.e(l)}finally{s.f()}}))}))},selectPatient:function(e){this.selected=e.selectIdx},breakMatch:function(){var e=this;if(this.breaks.length>0){this.$store.state.progress.enable=!0,this.$store.state.progress.title="Breaing Match";var t,a=this.$store.state.auth.username,s="/match/break-match?username=".concat(a),i=[],o=Object(r["a"])(this.breaks);try{for(o.s();!(t=o.n()).done;){var n=t.value;i.push("Patient/"+n.fid)}}catch(c){o.e(c)}finally{o.f()}this.$http.post(s,i).then((function(){e.$store.state.progress.enable=!1,e.countMatchIssues(),e.getPatient(),e.getAuditEvents()}))}},revertBreak:function(){var e=this;if(this.unbreaks.length>0){this.$store.state.progress.enable=!0,this.$store.state.progress.title="UnBreaing Match";var t,a=this.$store.state.auth.username,s="/match/unbreak-match?username=".concat(a),i=[],o=Object(r["a"])(this.unbreaks);try{for(o.s();!(t=o.n()).done;){var n,c=t.value,l=Object(r["a"])(this.match_items);try{for(l.s();!(n=l.n()).done;){var u=n.value;i.push({id2:"Patient/"+u.fid,id1:"Patient/"+c.fid})}}catch(d){l.e(d)}finally{l.f()}}}catch(d){o.e(d)}finally{o.f()}this.$http.post(s,i).then((function(){e.$store.state.progress.enable=!1,e.countMatchIssues(),e.getPatient(),e.getAuditEvents()}))}},getAuditEvents:function(){var t=this;this.matchEvents=[];var a="/fhir/AuditEvent?entity=".concat(this.$route.params.clientId,"&entity-name=submittedResource,breakTo,breakFrom,unBreak,unBreakFromResource&_sort=-_lastUpdated");this.$http.get(a).then((function(a){t.auditEvent=a.data;var s,i=Object(r["a"])(a.data.entry);try{for(i.s();!(s=i.n()).done;){var o=s.value,n={matchData:[]};n.recorded=o.resource.recorded;var c,l=o.resource.entity.find((function(e){return"break"===e.name||"breakFrom"===e.name})),u=o.resource.entity.find((function(e){return"unBreak"===e.name||"unBreakFromResource"===e.name})),d=void 0,v=Object(r["a"])(o.resource.subtype);try{for(v.s();!(c=v.n()).done;){var h=c.value;"http://hl7.org/fhir/restful-interaction"===h.system&&(d=h.code)}}catch(E){v.e(E)}finally{v.f()}if(n.operation=d,n.outcomeCode=o.resource.outcome,n.outcome=t.outcomes[o.resource.outcome],n.outcomeDesc=o.resource.outcomeDesc,o.resource.agent&&Array.isArray(o.resource.agent)){var m,p=Object(r["a"])(o.resource.agent);try{for(p.s();!(m=p.n()).done;){var f=m.value;f.altId&&(n.username=f.altId),f.network&&(n.ipaddress=f.network.address)}}catch(E){p.e(E)}finally{p.f()}}if(l){n.breakFrom=[],n.type="breakMatch";var _,b=Object(r["a"])(o.resource.entity);try{for(b.s();!(_=b.n()).done;){var y=_.value;"break"===y.name&&(n.break=y.what.reference),"oldCRUID"===y.name&&(n.CRUID=y.what.reference),"breakFrom"===y.name&&n.breakFrom.push(y.what.reference)}}catch(E){b.e(E)}finally{b.f()}t.matchEvents.push(n)}else if(u){n.unBreakFrom=[],n.type="unBreak";var g,w=Object(r["a"])(o.resource.entity);try{for(w.s();!(g=w.n()).done;){var k=g.value;"unBreak"===k.name&&(n.unBreak=k.what.reference),"unBreakFromCRUID"===k.name&&(n.unBreakFromCRUID=k.what.reference),"unBreakFromResource"===k.name&&n.unBreakFrom.push(k.what.reference)}}catch(E){w.e(E)}finally{w.f()}t.matchEvents.push(n)}else{var x,C=Object(r["a"])(o.resource.entity);try{for(C.s();!(x=C.n()).done;){var $=x.value;if("submittedResource"===$.name){n.type="submittedResource",n.submittedResource=$.what.reference;var I,V=Object(r["a"])($.detail);try{for(V.s();!(I=V.n()).done;){var R=I.value;if("resource"===R.type)n.submittedResourceData=R.valueString;else if("match"===R.type){var D=new e.from(R.valueBase64Binary,"base64").toString("ascii");D=JSON.parse(D);var S=[];for(var P in D.rule.fields){var M=D.rule.fields[P];S.push({name:P,id:P,details:M})}n.matchData.push({decisionRule:S,matchingType:D.rule.matchingType,filters:D.rule.filters,autoMatches:JSON.stringify(D.autoMatches,0,2),potentialMatches:JSON.stringify(D.potentialMatches,0,2),conflictsMatchResults:JSON.stringify(D.conflictMatches,0,2),query:JSON.stringify(D.query,0,2)})}}}catch(E){V.e(E)}finally{V.f()}}}}catch(E){C.e(E)}finally{C.f()}t.matchEvents.push(n)}}}catch(E){i.e(E)}finally{i.f()}}))},close:function(){window.close()}}}}).call(this,a("b639").Buffer)},"9b31":function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));a("7db0");var r=a("bc3a"),s=a.n(r),i={methods:{countMatchIssues:function(){var e=this;s.a.get("/match/count-match-issues").then((function(t){t.data&&(e.$store.state.totalMatchIssues=t.data.total)}))},getClientDisplayName:function(e){var t=this.$store.state.clients.find((function(t){return t.id===e}));if(t)return t.displayName},getClients:function(){var e=this;s.a.get("/config/getClients").then((function(t){e.$store.state.clients=t.data})).catch((function(e){throw e}))},getSystemURIDisplayName:function(e){var t,a;for(var r in this.$store.state.systemURI){var s=void 0;if(Array.isArray(this.$store.state.systemURI[r].uri)?s=this.$store.state.systemURI[r].uri.find((function(t){return t===e})):this.$store.state.systemURI[r].uri===e&&(s=e),s){t=this.$store.state.systemURI[r].displayName,a=r;break}}return{name:t,id:a}}}}}});
//# sourceMappingURL=app.509d77b3.js.map